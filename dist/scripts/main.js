function init(){renderer=new THREE.WebGLRenderer({antialias:!0}),vrEffect=new THREE.VREffect(renderer),vrEffect.setSize(window.innerWidth,window.innerHeight),renderer.setClearColor(2236962),renderer.setSize(window.innerWidth,window.innerHeight),renderer.domElement.style.position="absolute",container=document.getElementById("vrContainer"),container.appendChild(renderer.domElement),camera=new THREE.PerspectiveCamera(40,window.innerWidth/window.innerHeight,1,1e4),camera.position.z=3e3,vrControl=new THREE.VRFlyControls(camera),monoControl=new THREE.OrbitControls(camera,renderer.domElement),monoControl.rotateSpeed=.5,monoControl.minDistance=500,monoControl.maxDistance=6e3,scene=new THREE.Scene;for(var e=0;e<table.length;e++){var t=document.createElement("canvas");t.width=120,t.height=160;var o=t.getContext("2d"),l=new THREE.PlaneBufferGeometry(t.width,t.height),i=document.createElementNS(SVG_NS,"svg");i.setAttributeNS(null,"version","1.1"),i.setAttribute("xmlns",SVG_NS),i.setAttribute("width",t.width),i.setAttribute("height",t.height);var s=document.createElementNS(SVG_NS,"foreignObject");s.setAttribute("width","100%"),s.setAttribute("height","100%"),i.appendChild(s);var m=document.createElementNS(XHTML_NS,"div");m.setAttribute("xmlns",XHTML_NS),s.appendChild(m);var n=document.createElementNS(XHTML_NS,"div");n.style.backgroundColor="rgba(0,127,127,"+(.5*Math.random()+.25)+")",n.style.width="120px",n.style.height="160px",n.style.boxShadow="0px 0px 12px rgba(0, 255, 255, 0.5)",n.style.border="1px solid rgba(127, 255, 255, 0.25)",n.style.textAlign="center",m.appendChild(n);var a=document.createElementNS(XHTML_NS,"div");a.style.position="absolute",a.style.top="20px",a.style.right="20px",a.style.fontSize="12px",a.style.color="rgba(127, 255, 255, 0.75)",a.textContent=e+1,n.appendChild(a);var r=document.createElementNS(XHTML_NS,"div");r.style.position="absolute",r.style.top="40px",r.style.left="0px",r.style.right="0px",r.style.fontSize="60px",r.style.fontWeight="bold",r.style.color="rgba(255, 255, 255, 0.75)",r.style.textShadow="0px 0px 10px rgba(0, 255, 255, 0.95)",r.textContent=table[e].symbol,n.appendChild(r);var d=document.createElementNS(XHTML_NS,"div");d.style.position="absolute",d.style.top="110px",d.style.left="0px",d.style.right="0px",d.style.fontSize="12px",d.style.color="rgba(127, 255, 255, 0.75)",d.textContent=table[e].details,n.appendChild(d);var y=document.createElementNS(XHTML_NS,"div");y.style.position="absolute",y.style.bottom="15px",y.style.left="0px",y.style.right="0px",y.style.fontSize="12px",y.style.color="rgba(127, 255, 255, 0.75)",y.textContent=table[e].mol,n.appendChild(y);var b=new Blob([i.outerHTML],{type:"image/svg+xml;charset=utf-8"}),u=self.URL||self.webkitURL||self,x=u.createObjectURL(b),c=new Image;c.onload=function(e,o,l){return function(){l.drawImage(this,0,0,t.width,t.height),u.revokeObjectURL(e),drawnCounter++}}(x,c,o),c.src=x;var h=new THREE.Texture(t);h.minFilter=THREE.LinearFilter,h.magFilter=THREE.LinearFilter,h.needsUpdate=!0;var p=new THREE.MeshBasicMaterial({side:THREE.DoubleSide,transparent:!0,map:h}),E=new THREE.Mesh(l,p);E.position.x=4e3*Math.random()-2e3,E.position.y=4e3*Math.random()-2e3,E.position.z=4e3*Math.random()-2e3,scene.add(E),objects.push(E)}targets.table=createTableObjects(objects.length),targets.sphere=createSphereObjects(objects.length),targets.helix=createHelixObjects(objects.length),targets.grid=createGridObjects(objects.length),addAxisGrid(),helper=!0;var g=document.getElementById("table");g.addEventListener("click",function(){transform(targets.table,2e3)},!1);var f=document.getElementById("sphere");f.addEventListener("click",function(){transform(targets.sphere,2e3)},!1);var w=document.getElementById("helix");w.addEventListener("click",function(){transform(targets.helix,2e3)},!1);var v=document.getElementById("grid");v.addEventListener("click",function(){transform(targets.grid,2e3)},!1),window.addEventListener("dblclick",function(){modeVR=!0,vrEffect.setFullScreen(!0)},!1),document.addEventListener("mozfullscreenchange",function(){null===document.mozFullScreenElement&&(modeVR=!1)}),window.addEventListener("resize",onWindowResize,!1),window.addEventListener("keydown",onkey,!0);var S=document.getElementById("enterVR"),C=document.getElementById("getVR");VRClient.getVR.then(function(){C.classList.add("display-none")},function(){S.classList.add("display-none"),C.classList.remove("display-none")}),S.addEventListener("click",function(){modeVR=!0,vrEffect.setFullScreen(!0)},!1),transform(targets.table,5e3)}function createTableObjects(e){for(var t,o=[],l=0;e>l;l++)t=new THREE.Object3D,t.position.x=140*table[l].x-1330,t.position.y=-(180*table[l].y)+990,o.push(t);return o}function createSphereObjects(e){for(var t,o,l,i=[],s=new THREE.Vector3,m=0;e>m;m++)t=Math.acos(-1+2*m/e),o=Math.sqrt(e*Math.PI)*t,l=new THREE.Object3D,l.position.x=800*Math.cos(o)*Math.sin(t),l.position.y=800*Math.sin(o)*Math.sin(t),l.position.z=800*Math.cos(t),s.copy(l.position).multiplyScalar(2),l.lookAt(s),i.push(l);return i}function createHelixObjects(e){for(var t,o,l=[],i=new THREE.Vector3,s=0;e>s;s++)t=.175*s+Math.PI,o=new THREE.Object3D,o.position.x=900*Math.sin(t),o.position.y=-(8*s)+450,o.position.z=900*Math.cos(t),i.x=2*o.position.x,i.y=o.position.y,i.z=2*o.position.z,o.lookAt(i),l.push(o);return l}function createGridObjects(e){for(var t,o=[],l=0;e>l;l++)t=new THREE.Object3D,t.position.x=l%5*400-800,t.position.y=400*-(Math.floor(l/5)%5)+800,t.position.z=1e3*Math.floor(l/25)-2e3,o.push(t);return o}function transform(e,t){TWEEN.removeAll();for(var o=0;o<objects.length;o++){var l=objects[o],i=e[o],s=new TWEEN.Tween(l.position);s.to({x:i.position.x,y:i.position.y,z:i.position.z},Math.random()*t+t).easing(TWEEN.Easing.Exponential.InOut).start();var m=new TWEEN.Tween(l.rotation);m.to({x:i.rotation.x,y:i.rotation.y,z:i.rotation.z},Math.random()*t+t).easing(TWEEN.Easing.Exponential.InOut).start()}var n=new TWEEN.Tween;n.to({},2*t).onComplete(function(){switch(formState){case 0:transform(targets.sphere,5e3);break;case 1:transform(targets.helix,5e3);break;case 2:transform(targets.grid,5e3);break;case 3:transform(targets.table,5e3)}formState+=1,formState>3&&(formState=0)}).start()}function addAxisGrid(){axis=new THREE.AxisHelper(2e3),scene.add(axis),grid=new THREE.GridHelper(2e3,100),scene.add(grid),helper=!0}function removeAxisGrid(){scene.remove(axis),scene.remove(grid),helper=!1}function onWindowResize(){camera.aspect=window.innerWidth/window.innerHeight,camera.updateProjectionMatrix(),modeVR?vrEffect.setSize(window.innerWidth,window.innerHeight):renderer.setSize(window.innerWidth,window.innerHeight)}function animate(){requestAnimationFrame(animate),118>drawnCounter||(TWEEN.update(),modeVR?(vrControl.update(5),vrEffect.render(scene,camera)):(monoControl.update(),renderer.render(scene,camera)))}function onkey(e){e.preventDefault(),90===e.keyCode?vrControl.zeroSensor():70===e.keyCode||13===e.keyCode?vrEffect.setFullScreen(!0):72===e.keyCode&&(rotest(),helper?removeAxisGrid():addAxisGrid())}function rotest(){console.log(camera.rotation.x,camera.rotation.y,camera.rotation.z)}var table=[{symbol:"H",details:"Hydrogen",mol:"1.00794",x:1,y:1},{symbol:"He",details:"Helium",mol:"4.002602",x:18,y:1},{symbol:"Li",details:"Lithium",mol:"6.941",x:1,y:2},{symbol:"Be",details:"Beryllium",mol:"9.012182",x:2,y:2},{symbol:"B",details:"Boron",mol:"10.811",x:13,y:2},{symbol:"C",details:"Carbon",mol:"12.0107",x:14,y:2},{symbol:"N",details:"Nitrogen",mol:"14.0067",x:15,y:2},{symbol:"O",details:"Oxygen",mol:"15.9994",x:16,y:2},{symbol:"F",details:"Fluorine",mol:"18.9984032",x:17,y:2},{symbol:"Ne",details:"Neon",mol:"20.1797",x:18,y:2},{symbol:"Na",details:"Sodium",mol:"22.98976...",x:1,y:3},{symbol:"Mg",details:"Magnesium",mol:"24.305",x:2,y:3},{symbol:"Al",details:"Aluminium",mol:"26.9815386",x:13,y:3},{symbol:"Si",details:"Silicon",mol:"28.0855",x:14,y:3},{symbol:"P",details:"Phosphorus",mol:"30.973762",x:15,y:3},{symbol:"S",details:"Sulfur",mol:"32.065",x:16,y:3},{symbol:"Cl",details:"Chlorine",mol:"35.453",x:17,y:3},{symbol:"Ar",details:"Argon",mol:"39.948",x:18,y:3},{symbol:"K",details:"Potassium",mol:"39.948",x:1,y:4},{symbol:"Ca",details:"Calcium",mol:"40.078",x:2,y:4},{symbol:"Sc",details:"Scandium",mol:"44.955912",x:3,y:4},{symbol:"Ti",details:"Titanium",mol:"47.867",x:4,y:4},{symbol:"V",details:"Vanadium",mol:"50.9415",x:5,y:4},{symbol:"Cr",details:"Chromium",mol:"51.9961",x:6,y:4},{symbol:"Mn",details:"Manganese",mol:"54.938045",x:7,y:4},{symbol:"Fe",details:"Iron",mol:"55.845",x:8,y:4},{symbol:"Co",details:"Cobalt",mol:"58.933195",x:9,y:4},{symbol:"Ni",details:"Nickel",mol:"58.6934",x:10,y:4},{symbol:"Cu",details:"Copper",mol:"63.546",x:11,y:4},{symbol:"Zn",details:"Zinc",mol:"65.38",x:12,y:4},{symbol:"Ga",details:"Gallium",mol:"69.723",x:13,y:4},{symbol:"Ge",details:"Germanium",mol:"72.63",x:14,y:4},{symbol:"As",details:"Arsenic",mol:"74.9216",x:15,y:4},{symbol:"Se",details:"Selenium",mol:"78.96",x:16,y:4},{symbol:"Br",details:"Bromine",mol:"79.904",x:17,y:4},{symbol:"Kr",details:"Krypton",mol:"83.798",x:18,y:4},{symbol:"Rb",details:"Rubidium",mol:"85.4678",x:1,y:5},{symbol:"Sr",details:"Strontium",mol:"87.62",x:2,y:5},{symbol:"Y",details:"Yttrium",mol:"88.90585",x:3,y:5},{symbol:"Zr",details:"Zirconium",mol:"91.224",x:4,y:5},{symbol:"Nb",details:"Niobium",mol:"92.90628",x:5,y:5},{symbol:"Mo",details:"Molybdenum",mol:"95.96",x:6,y:5},{symbol:"Tc",details:"Technetium",mol:"(98)",x:7,y:5},{symbol:"Ru",details:"Ruthenium",mol:"101.07",x:8,y:5},{symbol:"Rh",details:"Rhodium",mol:"102.9055",x:9,y:5},{symbol:"Pd",details:"Palladium",mol:"106.42",x:10,y:5},{symbol:"Ag",details:"Silver",mol:"107.8682",x:11,y:5},{symbol:"Cd",details:"Cadmium",mol:"112.411",x:12,y:5},{symbol:"In",details:"Indium",mol:"114.818",x:13,y:5},{symbol:"Sn",details:"Tin",mol:"118.71",x:14,y:5},{symbol:"Sb",details:"Antimony",mol:"121.76",x:15,y:5},{symbol:"Te",details:"Tellurium",mol:"127.6",x:16,y:5},{symbol:"I",details:"Iodine",mol:"126.90447",x:17,y:5},{symbol:"Xe",details:"Xenon",mol:"131.293",x:18,y:5},{symbol:"Cs",details:"Caesium",mol:"132.9054",x:1,y:6},{symbol:"Ba",details:"Barium",mol:"132.9054",x:2,y:6},{symbol:"La",details:"Lanthanum",mol:"138.90547",x:4,y:9},{symbol:"Ce",details:"Cerium",mol:"140.116",x:5,y:9},{symbol:"Pr",details:"Praseodymium",mol:"140.90765",x:6,y:9},{symbol:"Nd",details:"Neodymium",mol:"144.242",x:7,y:9},{symbol:"Pm",details:"Promethium",mol:"(145)",x:8,y:9},{symbol:"Sm",details:"Samarium",mol:"150.36",x:9,y:9},{symbol:"Eu",details:"Europium",mol:"151.964",x:10,y:9},{symbol:"Gd",details:"Gadolinium",mol:"157.25",x:11,y:9},{symbol:"Tb",details:"Terbium",mol:"158.92535",x:12,y:9},{symbol:"Dy",details:"Dysprosium",mol:"162.5",x:13,y:9},{symbol:"Ho",details:"Holmium",mol:"164.93032",x:14,y:9},{symbol:"Er",details:"Erbium",mol:"167.259",x:15,y:9},{symbol:"Tm",details:"Thulium",mol:"168.93421",x:16,y:9},{symbol:"Yb",details:"Ytterbium",mol:"173.054",x:17,y:9},{symbol:"Lu",details:"Lutetium",mol:"174.9668",x:18,y:9},{symbol:"Hf",details:"Hafnium",mol:"178.49",x:4,y:6},{symbol:"Ta",details:"Tantalum",mol:"180.94788",x:5,y:6},{symbol:"W",details:"Tungsten",mol:"183.84",x:6,y:6},{symbol:"Re",details:"Rhenium",mol:"186.207",x:7,y:6},{symbol:"Os",details:"Osmium",mol:"190.23",x:8,y:6},{symbol:"Ir",details:"Iridium",mol:"192.217",x:9,y:6},{symbol:"Pt",details:"Platinum",mol:"195.084",x:10,y:6},{symbol:"Au",details:"Gold",mol:"196.966569",x:11,y:6},{symbol:"Hg",details:"Mercury",mol:"200.59",x:12,y:6},{symbol:"Tl",details:"Thallium",mol:"204.3833",x:13,y:6},{symbol:"Pb",details:"Lead",mol:"207.2",x:14,y:6},{symbol:"Bi",details:"Bismuth",mol:"208.9804",x:15,y:6},{symbol:"Po",details:"Polonium",mol:"(209)",x:16,y:6},{symbol:"At",details:"Astatine",mol:"(210)",x:17,y:6},{symbol:"Rn",details:"Radon",mol:"(222)",x:18,y:6},{symbol:"Fr",details:"Francium",mol:"(223)",x:1,y:7},{symbol:"Ra",details:"Radium",mol:"(226)",x:2,y:7},{symbol:"Ac",details:"Actinium",mol:"(227)",x:4,y:10},{symbol:"Th",details:"Thorium",mol:"232.03806",x:5,y:10},{symbol:"Pa",details:"Protactinium",mol:"231.0588",x:6,y:10},{symbol:"U",details:"Uranium",mol:"238.02891",x:7,y:10},{symbol:"Np",details:"Neptunium",mol:"(237)",x:8,y:10},{symbol:"Pu",details:"Plutonium",mol:"(244)",x:9,y:10},{symbol:"Am",details:"Americium",mol:"(243)",x:10,y:10},{symbol:"Cm",details:"Curium",mol:"(247)",x:11,y:10},{symbol:"Bk",details:"Berkelium",mol:"(247)",x:12,y:10},{symbol:"Cf",details:"Californium",mol:"(251)",x:13,y:10},{symbol:"Es",details:"Einstenium",mol:"(252)",x:14,y:10},{symbol:"Fm",details:"Fermium",mol:"(257)",x:15,y:10},{symbol:"Md",details:"Mendelevium",mol:"(258)",x:16,y:10},{symbol:"No",details:"Nobelium",mol:"(259)",x:17,y:10},{symbol:"Lr",details:"Lawrencium",mol:"(262)",x:18,y:10},{symbol:"Rf",details:"Rutherfordium",mol:"(267)",x:4,y:7},{symbol:"Db",details:"Dubnium",mol:"(268)",x:5,y:7},{symbol:"Sg",details:"Seaborgium",mol:"(271)",x:6,y:7},{symbol:"Bh",details:"Bohrium",mol:"(272)",x:7,y:7},{symbol:"Hs",details:"Hassium",mol:"(270)",x:8,y:7},{symbol:"Mt",details:"Meitnerium",mol:"(276)",x:9,y:7},{symbol:"Ds",details:"Darmstadium",mol:"(281)",x:10,y:7},{symbol:"Rg",details:"Roentgenium",mol:"(280)",x:11,y:7},{symbol:"Cn",details:"Copernicium",mol:"(285)",x:12,y:7},{symbol:"Uut",details:"Unutrium",mol:"(284)",x:13,y:7},{symbol:"Fl",details:"Flerovium",mol:"(289)",x:14,y:7},{symbol:"Uup",details:"Ununpentium",mol:"(288)",x:15,y:7},{symbol:"Lv",details:"Livermorium",mol:"(293)",x:16,y:7},{symbol:"Uus",details:"Ununseptium",mol:"(294)",x:17,y:7},{symbol:"Uuo",details:"Ununoctium",mol:"(294)",x:18,y:7}],container,camera,scene,vrEffect,renderer,vrControl,monoControl,helper,axis,grid,formState=0,drawnCounter=0,modeVR=!1,objects=[],targets={table:[],sphere:[],helix:[],grid:[]},SVG_NS="http://www.w3.org/2000/svg",XHTML_NS="http://www.w3.org/1999/xhtml";init(),animate();